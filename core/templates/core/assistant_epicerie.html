{% extends "core/base.html" %}
{% load static %}

{% block title %}Gestion d'Inventaire et Liste d'Épicerie{% endblock %}

{% block head_styles %}
    <style>
        .container {
            width: 100%;
            max-width: 1400px !important;
            padding: 0 !important;
            background: transparent !important;
            box-shadow: none !important;
        }
        .grid-stack-item-content {
            background-color: #ffffff;
            border-radius: 8px;
            border: 1px solid #e0e0e0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
            overflow: auto !important;
            padding: 20px;
            height: 100%;
            box-sizing: border-box;
            display: flex;
            flex-direction: column;
        }
        .grid-stack-item-content section {
            flex-grow: 1;
        }
        .grid-stack-item-content h1, .grid-stack-item-content h2, .grid-stack-item-content h3 {
            margin-top: 0;
            color: #2c3e50;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }
        .ui-resizable-handle {
            filter: brightness(0.8);
        }


        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            line-height: 1.6;
            background-color: #f4f7f9;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .content-wrapper {
            padding: 20px;
            display: flex;
            justify-content: center;
        }
        h1, h2 {
            color: #2c3e50;
            border-bottom: 2px solid #e0e0e0;
            padding-bottom: 10px;
        }
        h3.category-title {
             scroll-margin-top: 20px;
        }
        .inventory-section, .shopping-list-section {
            margin-bottom: 30px;
        }
        .category-title {
            color: #3498db;
            margin-top: 20px;
            margin-bottom: 10px;
        }
        ul {
            list-style: none;
            padding: 0;
        }
        li {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid #eee;
        }
        li:last-child {
            border-bottom: none;
        }
        .shopping-list-item {
            cursor: grab;
        }
        .shopping-list-item.dragging {
            opacity: 0.5;
            background-color: #ecf0f1;
        }
        .shopping-list-item.drag-over {
            border-top: 2px solid #3498db;
        }
        .inventory-item {
            cursor: grab;
        }
        .inventory-item.dragging {
            opacity: 0.5;
            background-color: #ecf0f1;
        }
        .inventory-item.drag-over {
            border-top: 2px solid #3498db;
        }
        .inventory-section.drag-over {
            background-color: #e8f4fd; /* Bleu clair pour indiquer une zone de dépôt */
            border-radius: 8px;
        }
        .low-quantity-warning {
            background-color: #fcf8e3; /* Jaune pâle */
            border-left: 4px solid #f39c12; /* Bordure orange */
            padding-left: 10px; /* Ajouter un peu d'espace */
            margin-left: -14px; /* Compenser le padding et la bordure */
        }
        li.low-quantity-warning {
             border-bottom: 1px solid #e0d9c3;
        }
        .item-details {
            display: flex;
            align-items: center;
            gap: 10px;
            flex-grow: 1; /* Permet aux détails de prendre l'espace */
        }
        .item-name {
            font-weight: 500;
        }
        .inventory-item-name {
             cursor: pointer;
             font-weight: 500;
        }
        .inventory-item-name:hover {
            text-decoration: underline;
            color: #3498db;
        }
        .item-controls, .shopping-item-controls {
            display: flex;
            align-items: center;
            gap: 8px;
        }
        .item-controls input[type="text"] {
            width: 50px;
            text-align: center;
            border: 1px solid #ddd;
            border-radius: 4px;
            padding: 5px;
        }
        .btn {
            padding: 8px 15px;
            border: none;
            border-radius: 5px;
            color: white;
            cursor: pointer;
            font-size: 14px;
            white-space: nowrap;
        }
        .btn-delete { background-color: #e74c3c; }
        .btn-delete:hover { background-color: #c0392b; }
        .btn-move { background-color: #3498db; }
        .btn-move:hover { background-color: #2980b9; }
        .add-item-form {
            background-color: #ecf0f1;
            padding: 20px;
            border-radius: 8px;
            display: flex;
            gap: 15px;
            flex-wrap: wrap;
            margin-bottom: 20px;
        }
        .add-item-form input, .add-item-form select, .add-item-form button {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #bdc3c7;
            font-size: 16px;
        }
        .add-item-form input[type="text"] { flex: 2; }
        .add-item-form input[type="text"], .add-item-form select { min-width: 150px; }
        .add-item-form button {
            background-color: #2ecc71;
            color: white;
            border: none;
            cursor: pointer;
            flex: 1;
            min-width: 100px;
        }
        .add-item-form button:hover { background-color: #27ae60; }
        .recipe-section {
            text-align: center;
            margin-top: 30px;
            padding-top: 20px;
            border-top: 2px solid #e0e0e0;
        }
        .recipe-options {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 15px;
            color: #555;
        }
        .btn-recipe {
            background-color: #8e44ad;
            color: white;
            padding: 12px 25px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            transition: background-color 0.3s;
        }
        .btn-recipe:hover { background-color: #9b59b6; }
        .inventory-controls {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        #prompt-output-section {
            background-color: #e8f4fd;
            border: 1px solid #d1e9fc;
            border-radius: 8px;
            padding: 20px;
            margin-top: 25px;
        }
        .import-section {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 20px;
            border-radius: 8px;
            margin-top: 20px;
        }
        .import-section textarea {
            width: 100%;
            min-height: 100px;
            box-sizing: border-box;
            border: 1px solid #ced4da;
            border-radius: 5px;
            padding: 10px;
            font-family: monospace;
            margin-bottom: 10px;
        }
        .import-section button {
            width: 100%;
            background-color: #16a085;
        }
        .import-section button:hover {
            background-color: #117a65;
        }
        #recipe-list-display {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
        }
        .recipe-card {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            border-radius: 8px;
            padding: 15px;
            cursor: pointer;
            transition: box-shadow 0.3s, transform 0.3s;
        }
        .recipe-card:hover {
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            transform: translateY(-3px);
        }
        .recipe-card h3 {
            margin: 0 0 10px 0;
            color: #34495e;
            font-size: 1.1em;
        }
        .modal {
            display: none; position: fixed; z-index: 1056; left: 0; top: 0;
            width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.6);
            animation: fadeIn 0.3s;
        }
        @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
        .modal-content {
            background-color: #fefefe; margin: 5% auto; padding: 25px;
            border: 1px solid #888; width: 90%; max-width: 700px; /* Largeur augmentée */
            border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.3);
            animation: slideIn 0.4s;
        }
        @keyframes slideIn { from { transform: translateY(-50px); opacity: 0; } to { transform: translateY(0); opacity: 1; } }
        .modal-header {
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid #ddd; padding-bottom: 15px; margin-bottom: 20px;
        }
        .modal-header h2 { margin: 0; color: #2c3e50; border: none; }
        .close-btn { color: #aaa; font-size: 28px; font-weight: bold; cursor: pointer; }
        .close-btn:hover { color: black; }
        .modal-body label { display: block; margin-bottom: 8px; font-weight: 500; color: #555; }
        .modal-body textarea, .modal-body input {
            width: 100%; padding: 10px; margin-bottom: 15px; border-radius: 5px;
            border: 1px solid #ccc; font-size: 1em; box-sizing: border-box;
        }
        .modal-body textarea { min-height: 120px; resize: vertical; }
        .modal-footer { text-align: right; margin-top: 20px; }
        .recipe-view-content h3 { color: #3498db; margin-top: 15px; }
        .recipe-view-content pre {
            background-color: #f4f7f9; padding: 10px; border-radius: 5px;
            white-space: pre-wrap; word-wrap: break-word; font-family: inherit;
        }
        .ai-importer-section {
            background-color: #e8f4fd;
            border: 1px solid #d1e9fc;
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 25px;
        }
        .ai-importer-section h4 {
            margin-top: 0;
            color: #2c3e50;
        }
        .ai-importer-section textarea {
            font-family: monospace;
            background-color: #f8f9fa;
        }
        .ai-importer-section .btn-group {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        .json-importer-section {
             background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
        }
        /* --- STYLES POUR L'AUTHENTIFICATION --- */
        #auth-section {
            background-color: #ecf0f1;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 25px;
            border: 1px solid #bdc3c7;
        }
        .auth-container {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        #user-status {
            font-weight: 500;
        }
        #user-status button {
            margin-left: 10px;
        }
        #auth-forms {
            display: flex;
            gap: 10px;
        }
        #auth-forms input {
            padding: 8px;
            border-radius: 4px;
            border: 1px solid #bdc3c7;
        }
        .auth-toggle {
            margin-top: 10px;
            font-size: 0.9em;
        }
        .auth-toggle a {
            color: #3498db;
            cursor: pointer;
            text-decoration: underline;
        }

        /* --- STYLES POUR CACHER/AFFICHER LES ÉLÉMENTS --- */
        .hidden {
            display: none !important;
        }
           
        /* Styles pour la section de gestion */
        .data-management-section {
            background-color: #f8f9fa;
            border: 1px solid #e9ecef;
            padding: 20px;
            border-radius: 8px;
            margin-top: 30px;
        }
        .data-management-section h3 {
            margin-top: 0;
            color: #34495e;
        }
        .data-management-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }
    </style>
{% endblock %}

{% block content %}
            <div class="grid-stack">
                <!-- WIDGET 1: Inventaire -->
                <div class="grid-stack-item" gs-id="inventory-widget" gs-w="8" gs-h="6" gs-x="0" gs-y="0">
                    <div class="grid-stack-item-content">
                        <section id="inventory-section">
                            <h1>Inventaire des Denrées</h1>
                            <div class="inventory-controls">
                                <div>
                                    <input type="checkbox" id="toggleAll" name="toggleAll">
                                    <label for="toggleAll">Cocher/décocher tout</label>
                                </div>
                                <button id="addLowStockItemsBtn" class="btn" style="background-color: #e67e22;">Ajouter les articles en pénurie à la liste</button>
                            </div>
                            <div id="inventory-display"></div>
                        </section>
                    </div>
                </div>

                <!-- WIDGET 2: Outils -->
                <div class="grid-stack-item" gs-id="tools-widget" gs-w="4" gs-h="7" gs-x="8" gs-y="0">
                    <div class="grid-stack-item-content">
                        <section id="add-item-section" class="mb-4">
                            <h2>Ajouter un Nouvel Article à l'Inventaire</h2>
                            <form id="addItemForm" class="row g-3 align-items-center p-3 bg-light rounded-3 border">
                                <div class="col-sm-4">
                                    <label for="itemName" class="visually-hidden">Nom</label>
                                    <input type="text" class="form-control" id="itemName" placeholder="Nom de l'article" required>
                                </div>
                                <div class="col-sm-2">
                                    <label for="itemQuantity" class="visually-hidden">Quantité</label>
                                    <input type="text" class="form-control" id="itemQuantity" value="1" placeholder="Quantité">
                                </div>
                                <!-- DÉBUT DES MODIFICATIONS DU FORMULAIRE -->
                                <div class="col-sm-3">
                                    <label for="itemCategory" class="visually-hidden">Catégorie</label>
                                    <div class="input-group">
                                        <select id="itemCategory" class="form-select">
                                            <!-- Les catégories seront chargées ici par JS -->
                                        </select>
                                    <button class="btn btn-outline-secondary" type="button" id="add-category-btn" title="Ajouter une catégorie">+</button>
                                    </div>
                                </div>
                                <!-- FIN DES MODIFICATIONS DU FORMULAIRE -->
                                <div class="col-auto">
                                    <button type="submit" class="btn btn-primary"><i class="bi bi-plus-circle"></i> Ajouter</button>
                                </div>
                            </form>
                        </section>
                        <section id="data-management" class="data-management-section">
                            <h3>Gestion des Données d'Inventaire</h3>
                            <p>Utilisez ces outils pour migrer votre ancien inventaire local vers votre compte.</p>
                            <div class="data-management-buttons">
                                <button id="view-old-inventory-btn" class="btn" style="background-color: #95a5a6;">Voir l'inventaire local</button>
                                <button id="export-inventory-btn" class="btn" style="background-color: #16a085;">Exporter l'inventaire local</button>
                                <button id="export-server-inventory-btn" class="btn" style="background-color: #27ae60;">Exporter l'inventaire utilisateur</button>
                                <button id="import-inventory-btn" class="btn" style="background-color: #3498db;">Importer un inventaire</button>
                                <!-- Input caché pour la sélection de fichier -->
                                <input type="file" id="inventory-file-input" class="hidden" accept=".json">
                            </div>
                        </section>
                    </div>
                </div>

                <div class="grid-stack-item" gs-id="shopping-list-widget" gs-w="8" gs-h="5" gs-x="0" gs-y="6">
                    <div class="grid-stack-item-content">
                        <section id="shopping-list-section" class="shopping-list-section">
                            <h2>Liste d'Épicerie</h2>
                            <div id="shopping-list-display"></div>
                            <h3>Ajouter à la liste d'épicerie</h3>
                            <form id="addShoppingItemForm" class="add-item-form">
                                <input type="text" id="shoppingItemName" placeholder="Nom de l'article" required>
                                <input type="text" id="shoppingItemQuantity" value="1" placeholder="Quantité">
                                <button type="submit">Ajouter à la liste</button>
                            </form>

                            <div id="import-section" class="import-section">
                                <h3>Importer une liste depuis Gemini</h3>
                                <p style="margin-top:0; font-size: 0.9em; color: #555;">Collez ici le JSON fourni par Gemini pour ajouter plusieurs articles à votre liste.</p>
                                <textarea id="importShoppingListTextarea" placeholder='[{"name": "Oignons", "quantity": "2"}, {"name": "Ail", "quantity": "1 tête"}]'></textarea>
                                <button id="importShoppingListBtn" class="btn">Importer la liste</button>
                            </div>
                        </section>
                    </div>
                </div>
                        
                <div class="grid-stack-item" gs-id="recipe-book-widget" gs-w="4" gs-h="5" gs-x="8" gs-y="6">
                    <div class="grid-stack-item-content">
                        <section id="recipe-book-section">
                            <h2>Livre de recettes</h2>
                            <button id="show-add-recipe-modal-btn" class="btn" style="background-color: #16a085; margin-bottom: 20px;">Ajouter une recette</button>
                            <!-- Utilisation du système de grille de Bootstrap pour les cartes -->
                            <div id="recipe-list-display" class="row row-cols-1 row-cols-md-2 row-cols-lg-3 g-3">
                                <!-- Le JS remplira cette section avec des cartes -->
                            </div>
                        </section>
                    </div>
                </div>

                <div class="grid-stack-item" gs-id="generate-list-widget" gs-w="6" gs-h="5" gs-x="0" gs-y="11">
                    <div class="grid-stack-item-content">
                        <section id="ai-shopping-list-generator">
                            <h2>Générer une Liste d'Épicerie avec l'IA</h2>
                            <form id="aiShoppingListForm" class="add-item-form" style="display: block;">
                                <div style="width: 100%; margin-bottom: 10px; display: flex; align-items: center; gap: 10px;">
                                    <label for="numPeople">Nombre de personnes:</label>
                                    <input type="number" id="numPeople" value="2" min="1" style="width: 80px; padding: 8px;">
                                </div>
                                <div style="width: 100%; margin-bottom: 10px;">
                                    <label for="mealsList" style="display: block; margin-bottom: 5px;">Repas à préparer (un par ligne):</label>
                                    <textarea id="mealsList" rows="4" placeholder="Ex: Pâté chinois&#10;Spaghetti bolognaise&#10;Soupe aux légumes" style="width: 100%; padding: 8px; border-radius: 5px; border: 1px solid #bdc3c7; font-size: 16px; box-sizing: border-box;"></textarea>
                                </div>
                                <button type="button" id="generateShoppingListBtn" class="btn-recipe" style="width: 100%;">Générer l'instruction pour l'IA</button>
                            </form>
                        </section>
                    </div>
                </div>

                <div class="grid-stack-item" gs-id="recipe-generator-widget" gs-w="6" gs-h="5" gs-x="6" gs-y="11">
                    <div class="grid-stack-item-content">
                        <section id="recipe-section" class="recipe-section">
                            <h2>Trouver une Recette</h2>
                            <div class="recipe-options" style="margin-bottom: 5px;">
                                <input type="checkbox" id="includeExtraIngredients" name="includeExtraIngredients">
                                <label for="includeExtraIngredients">Permettre des ingrédients manquants</label>
                            </div>
                            <div class="recipe-options">
                                <input type="checkbox" id="useFlyerDeals" name="useFlyerDeals">
                                <label for="useFlyerDeals">Utiliser les articles en rabais des circulaires</label>
                            </div>
                            
                            <h3 style="color: #34495e; font-size: 1.1em; margin-top: 20px; margin-bottom: 10px; border-top: 1px solid #eee; padding-top: 15px;">Options de cuisson</h3>
                            <div class="recipe-options" style="flex-direction: column; align-items: flex-start; gap: 8px; max-width: 300px; margin-left: auto; margin-right: auto; text-align: left;">
                                <div>
                                    <input type="checkbox" id="recipeCatNoOven" name="recipeCatNoOven">
                                    <label for="recipeCatNoOven">Pas de four (cuisinière seulement)</label>
                                </div>
                                <div>
                                    <input type="checkbox" id="recipeCatNoCook" name="recipeCatNoCook">
                                    <label for="recipeCatNoCook">Pas de cuisson</label>
                                </div>
                                <div>
                                    <input type="checkbox" id="recipeCatQuick" name="recipeCatQuick">
                                    <label for="recipeCatQuick">Repas rapide (moins de 30 minutes)</label>
                                </div>
                            </div>

                            <button id="generateRecipeBtn" class="btn-recipe" style="margin-top: 20px;">Générer l'instruction pour l'IA</button>
                        </section>

                        <section id="prompt-output-section" style="display: none;">
                            <h3>Votre instruction pour l'IA est prête</h3>
                            <p><strong>Étape 1 :</strong> Copiez le texte ci-dessous. <strong>Étape 2 :</strong> Ouvrez Gemini et collez-le.</p>
                            <textarea id="prompt-output-textarea" rows="10" style="width: 100%; box-sizing: border-box; font-family: monospace; padding: 10px; border-radius: 5px; border: 1px solid #ccc;"></textarea>
                            <div style="margin-top: 10px; display: flex; gap: 10px;">
                                <button id="copy-prompt-btn" class="btn" style="background-color: #27ae60;">Copier le texte</button>
                                <a href="https://gemini.google.com/app" target="_blank" class="btn" style="background-color: #8e44ad; text-decoration: none; text-align: center;">Ouvrir Gemini</a>
                            </div>
                        </section>
                    </div>
                </div>
            </div>
        

    <!-- Modale pour ajouter/éditer une recette -->
    <div id="recipe-form-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="recipe-modal-title">Ajouter une Nouvelle Recette</h2>
                <span class="close-btn" id="close-recipe-form-modal">&times;</span>
            </div>
            <div class="modal-body">

                <!-- NOUVELLE SECTION D'IMPORTATION IA -->
                <div class="ai-importer-section">
                    <h4>Importer une recette avec l'IA</h4>
                    <p style="margin-top:0; font-size: 0.9em; color: #555;">
                        <b>Étape 1:</b> Copiez l'instruction. <b>Étape 2:</b> Collez-la dans Gemini, suivie du lien ou du texte de la recette.
                    </p>
                    <textarea id="ai-recipe-prompt" rows="8" readonly>
Agis comme un extracteur de données de recettes. Transforme la recette que je vais fournir en un format JSON.
Le JSON doit contenir les clés suivantes : "name" (string), "ingredients" (string, avec chaque ingrédient sur une nouvelle ligne), "instructions" (string, avec chaque étape sur une nouvelle ligne), et "comments" (string, pour les notes additionnelles).

Ne fournis AUCUN texte avant ou après le bloc JSON.

Exemple de format :
{
  "name": "Crêpes faciles",
  "ingredients": "1 tasse de farine\n2 oeufs\n1/2 tasse de lait\n1/4 tasse d'eau\n2 c. à soupe de beurre fondu",
  "instructions": "Mélanger tous les ingrédients.\nFaire cuire dans une poêle chaude.",
  "comments": "Servir avec du sirop d'érable."
}

Maintenant, analyse la recette suivante :
                    </textarea>
                    <div class="btn-group">
                        <button type="button" id="copy-recipe-prompt-btn" class="btn" style="background-color: #27ae60;">Copier l'instruction</button>
                        <a href="https://gemini.google.com/app" target="_blank" class="btn" style="background-color: #8e44ad; text-decoration: none;">Ouvrir Gemini</a>
                    </div>
                </div>

                <div class="json-importer-section">
                    <label for="recipe-json-input"><b>Étape 3:</b> Collez le JSON de Gemini ici</label>
                    <textarea id="recipe-json-input" rows="4" placeholder='{ "name": "...", "ingredients": "...", ... }'></textarea>
                    <button type="button" id="import-recipe-json-btn" class="btn" style="background-color: #3498db; width: 100%;">Importer et Remplir les champs</button>
                </div>
                <!-- FIN DE LA NOUVELLE SECTION -->
                
                <hr style="margin: 30px 0;">

                <form id="recipe-form">
                    <input type="hidden" id="recipe-id">
                    <label for="recipe-name">Nom de la recette</label>
                    <input type="text" id="recipe-name" required>
                    
                    <label for="recipe-ingredients">Ingrédients (un par ligne)</label>
                    <textarea id="recipe-ingredients" placeholder="Ex: 1 tasse de farine&#10;2 oeufs" required></textarea>
                    
                    <label for="recipe-instructions">Instructions</label>
                    <textarea id="recipe-instructions" required></textarea>
                    
                    <label for="recipe-comments">Commentaires / Notes</label>
                    <textarea id="recipe-comments"></textarea>
                    
                    <div class="modal-footer">
                        <button type="submit" class="btn" style="background-color: #2ecc71;">Sauvegarder</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <!-- Modale pour voir une recette -->
    <div id="recipe-view-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="recipe-view-title"></h2>
                <span class="close-btn" id="close-recipe-view-modal">&times;</span>
            </div>
            <div class="modal-body recipe-view-content">
                <h3>Ingrédients</h3>
                <pre id="recipe-view-ingredients"></pre>
                
                <h3>Instructions</h3>
                <pre id="recipe-view-instructions"></pre>
                
                <h3>Commentaires / Notes</h3>
                <pre id="recipe-view-comments"></pre>
            </div>
            <div class="modal-footer" id="recipe-view-footer">
                <!-- Les boutons seront injectés par le script -->
            </div>
        </div>
    </div>

    <!-- Modale pour voir l'ancien inventaire -->
    <div id="view-old-data-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Ancien Inventaire (depuis le stockage local)</h2>
                <span class="close-btn" id="close-old-data-modal">&times;</span>
            </div>
            <div class="modal-body" id="old-data-content">
                <!-- Le contenu sera injecté par le script -->
            </div>
        </div>
    </div>

{% endblock %}

{% block body_scripts %}
    <script src="https://cdn.jsdelivr.net/npm/gridstack@10.2.0/dist/gridstack-all.js"></script>
    <script src="{% static 'js/assistant_page.js' %}"></script>
{% endblock %}